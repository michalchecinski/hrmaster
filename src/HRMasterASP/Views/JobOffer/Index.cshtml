@model IEnumerable<JobOffer>

<div class="row page-box">
    <div class="col-sm-12">
        <h2>Job Offer list</h2>

        <div class="input-group col-md-12" style="margin-bottom: 14px">
            <input type="text" class="form-control" placeholder="Search by offer title.."
                   name="search" id="search" />
            <span class="input-group-btn">
                <button class="btn btn-info" type="submit" onclick="find();">
                    <i class="glyphicon glyphicon-search"></i>
                </button>
            </span>
        </div>

        <script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-2.0.3.min.js"></script>
        <script>
        var uri = '/api/JobOfferSearch';

        $(document).ready(function () {
            // Send an AJAX request
            $.getJSON(uri)
                .done(function (data) {
                    // On success, 'data' contains a list of products.
                    $.each(data, function (key, item) {
                        // Add a list item for the product.
                        $("#table-body").append(formatItem(item));
                    });
                });
        })

        function formatItem(item) {
            return '<tr>'+
                    '<td><a href="/JobOffer/Details?id='+item.id+'\">'+item.jobTitle+`</a></td>
                    <td>`+item.company.name+`</td>
                    <td>`+ item.location+`</td>
                    <td>`+item.created+`</td>
                    </tr >`;
        }

        function find() {
            var query = $('#search').val();
            $.getJSON(uri + '?search=' + query)
                .done(function (data) {
                    $("#table-body").html("");
                    $.each(data, function (key, item) {
                        $("#table-body").append(formatItem(item));
                    });
                })
                .fail(function (jqXHR, textStatus, err) {
                    $('#table-body').text('Error: ' + err);
                });
        }
        </script>


        <table class="table table-striped table-hover">
            <thead class="thead-dark">
                <tr>
                    <th scope="col">Job Title</th>
                    <th scope="col">Company</th>
                    <th scope="col">Location</th>
                    <th scope="col">Created</th>
                </tr>
            </thead>
            <tbody id="table-body">
            </tbody>
        </table>
        @Html.ActionLink("Create job offer", "Create", "JobOffer", null, new { @class = "btn btn-primary" })
    </div>
</div>


